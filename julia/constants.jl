## d = 1
# p = 0.95
Dict(
  "p" => [0.95, 0.95, 0.95, 0.95], 
  "prob" => [0.75, 0.5, 0.25, 0.],
  "interval" => [(1., 1.2), (1., 1.15), (1., 1.02), (0.01, 1.0)])

# p = 0.9
Dict(
  "p" => [0.9, 0.9, 0.9, 0.9], 
  "prob" => [0.75, 0.5, 0.25, 0.],
  "interval" => [(1.12, 1.4), (1.08, 1.2), (1.01, 1.13), (0.01, 1.01)])

# p = 0.8
Dict(
  "p" => [0.8, 0.8, 0.8, 0.8], 
  "prob" => [0.75, 0.5, 0.25, 0.],
  "interval" => [(1.21, 1.94), (1.11, 1.46), (1.01, 1.27), (0.01, 1.01)])

# p = 0.7
Dict(
  "p" => [0.7, 0.7, 0.7, 0.7], 
  "prob" => [0.75, 0.5, 0.25, 0.],
  "interval" => [(1.4, 2.8), (1.43, 1.463), (1.121, 1.262), (0.01, 1.121)])

# p = 0.6
Dict(
  "p" => [0.6, 0.6, 0.6, 0.6], 
  "prob" => [0.75, 0.5, 0.25, 0.],
  "interval" => [(1.77, 4.5), (1.43, 2.31), (1.11, 1.78), (0.01, 1.11)])

# p = 0.5
Dict(
  "p" => [0.5, 0.5, 0.5, 0.5], 
  "prob" => [0.75, 0.5, 0.25, 0.],
  "interval" => [(2.29, 9), (1.77, 3.32), (1.25, 2.35), (0.01, 1.51)])

###
using Plots

x = range(1.2, 9, length=300)
y = pF.(x, 0.5, 1)
y2 = pF.(x, 0.6, 1)

y[300]
x[180]

plot(x, y, legend =:bottomright)
plot!(x, y2)


x[findall(y .> 0.25)[1]]
x[findall(y2 .<= 0.5)[end]]

x[findall(y2 .> 0.25)[1]]
x[findall(y .<= 0.25)[end]]

l,u = 0.5, 75
minimum([x[findall(y .> l)[1]],x[findall(y2 .<= u)[end]],
  x[findall(y2 .> l)[1]],x[findall(y .<= u)[end]]])

maximum([x[findall(y .> l)[1]],x[findall(y2 .<= u)[end]],
  x[findall(y2 .> l)[1]], x[findall(y .<= u)[end]]])


@time find_zero(x -> qF₁(x, 0.99, 0.6, 1), (1.77,4.5), xatol=1e-4)

d1 = Dict(
  "p" => [0.95, 0.95, 0.95, 0.95], 
  "prob" => [0.75, 0.5, 0.25, 0.],
  "interval" => [(1., 1.2), (1., 1.15), (1., 1.02), (0.1, 1.0)])


